# Applies the fix for protobuf broken code using the protoletariat package:

if (NOT "@PROTOL_PKG_DIR@" STREQUAL "")
    set(ENV{PYTHONPATH} @PROTOL_PKG_DIR@)
endif()

execute_process(
    COMMAND
    @PROTOL_EXECUTABLE@ --create-package --in-place --python-out @MVSIM_PYTHON_BUILD_DIRECTORY@/mvsim_msgs/ protoc --proto-path=@CMAKE_CURRENT_SOURCE_DIR@/proto @PROTOBUF_DEFINITION_FILES@
    RESULT_VARIABLE CMD_RES
)

if (NOT CMD_RES EQUAL 0)
    message(FATAL_ERROR "Error invoking protol (see above)")
endif()

<mvsim_world version="1.0">
	<!-- General simulation options -->
	<simul_timestep>0</simul_timestep> <!-- Simulation fixed-time interval for numerical integration [seconds] or 0 to autodetermine -->

	<!-- GUI options -->
	<gui>
		<ortho>false</ortho>
		<show_forces>false</show_forces>  <force_scale>0.01</force_scale>
		<cam_distance>25</cam_distance>
		<fov_deg>60</fov_deg>
		<refresh_fps>20</refresh_fps>
		<!-- <follow_vehicle>r1</follow_vehicle> -->
	</gui>

	<variable name="CEILING_HEIGHT" value="6.0"></variable>

	<!-- ========================
		   Scenario definition
	     ======================== -->
	<!-- ground -->
	<element class="horizontal_plane">
		<cull_face>BACK</cull_face>
		<x_min>-15</x_min> <y_min>-13</y_min>
		<x_max> 20</x_max> <y_max> 13</y_max>
		<z>0.0</z>
		<texture>https://mrpt.github.io/mvsim-models/textures-cgbookcase/concrete-ground-1.jpg</texture>
		<texture_size_x>2.0</texture_size_x>
		<texture_size_y>2.0</texture_size_y>
	</element>

	<!-- ceiling -->
	<element class="horizontal_plane">
		<cull_face>FRONT</cull_face>
		<x_min>-15</x_min> <y_min>-13</y_min>
		<x_max> 20</x_max> <y_max> 13</y_max>
		<z>$f{CEILING_HEIGHT}</z>
		<texture>https://mrpt.github.io/mvsim-models/textures-cgbookcase/BathroomTiles03_1K_BaseColor.png</texture>
		<texture_size_x>3.0</texture_size_x>
		<texture_size_y>3.0</texture_size_y>
	</element>

	<!-- perimeter walls: -->
	<element class="vertical_plane">
		<cull_face>FRONT</cull_face>
		<x0>-15</x0> <y0>13</y0>
		<x1>-15</x1> <y1>-13</y1>
		<z>0.0</z> <height>$f{CEILING_HEIGHT}</height>
		<texture>https://mrpt.github.io/mvsim-models/textures-cgbookcase/wall-bricks-01.png</texture>
		<texture_size_x>3.0</texture_size_x>
		<texture_size_y>3.0</texture_size_y>
	</element>
	<element class="vertical_plane">
		<cull_face>FRONT</cull_face>
		<x0> 20</x0> <y0>13</y0>
		<x1>-15</x1> <y1>13</y1>
		<z>0.0</z> <height>$f{CEILING_HEIGHT}</height>
		<texture>https://mrpt.github.io/mvsim-models/textures-cgbookcase/wall-bricks-01.png</texture>
		<texture_size_x>3.0</texture_size_x>
		<texture_size_y>3.0</texture_size_y>
	</element>
	<element class="vertical_plane">
		<cull_face>FRONT</cull_face>
		<x0> 20</x0> <y0>-13</y0>
		<x1> 20</x1> <y1>13</y1>
		<z>0.0</z> <height>$f{CEILING_HEIGHT}</height>
		<texture>https://mrpt.github.io/mvsim-models/textures-cgbookcase/wall-bricks-01.png</texture>
		<texture_size_x>3.0</texture_size_x>
		<texture_size_y>3.0</texture_size_y>
	</element>
	<element class="vertical_plane">
		<cull_face>FRONT</cull_face>
		<x0>-15</x0> <y0>-13</y0>
		<x1> 20</x1> <y1>-13</y1>
		<z>0.0</z> <height>$f{CEILING_HEIGHT}</height>
		<texture>https://mrpt.github.io/mvsim-models/textures-cgbookcase/wall-bricks-01.png</texture>
		<texture_size_x>3.0</texture_size_x>
		<texture_size_y>3.0</texture_size_y>
	</element>

	<!-- =============================
		   Vehicle classes definition
	     ============================= -->
	<include file="definitions/jackal.vehicle.xml" />

	<!-- ========================
		   Vehicle(s) definition
	     ======================== -->
	<vehicle name="r1" class="jackal">
		<init_pose>0 0 0</init_pose>  <!-- In global coords: x,y, yaw(deg) -->

		<!--<publish>
		  <publish_pose_topic>/${NAME}/pose</publish_pose_topic>
		  <publish_pose_period>50e-3</publish_pose_period>
		</publish>-->

		<!-- Sensors -->
<!--		<include file="definitions/lidar2d.sensor.xml"
		  sensor_x="-0.15" sensor_z="0.25" sensor_yaw="180"
		  sensor_period_sec="0.10"
		  raytrace_3d="false"
		  sensor_name="scanner1"
		/>-->

		<include file="definitions/velodyne-vlp16.sensor.xml"
		  sensor_x="0.15" sensor_z="$f{0.27 + 0.09}"
		  sensor_std_noise="0.02"
		  sensor_publish="false"
		  sensor_name="lidar1"
		  sensor_rpm="600"
		/>
		
		<include file="definitions/camera.sensor.xml" 
		  sensor_x="0.2"  sensor_y="0" sensor_z="0.27"
		  sensor_period_sec="0.10"
		  sensor_name="cam1"
		  />		
	</vehicle>

	<!-- ======================================
	      Object types
	     ====================================== -->
	<block:class name="shelf">
		<static>true</static> <!-- Does not move -->
		<mass>300</mass> <zmax>2.0</zmax> <ground_friction>1.0</ground_friction>
		<shape_from_visual/> <!-- automatic size from 3D model file -->
		<!--  Custom visualization model. 3D model filename to load (local or remote http://uri ) -->
		<visual>
			<model_uri>https://mrpt.github.io/mvsim-models/shelf_big_moveai.zip/shelf_big_moveai/shelf_big_movai.dae</model_uri>
			<model_roll>90.0</model_roll>
		</visual>
	</block:class>

	<block:class name="stairs">
		<static>true</static> <!-- Does not move -->
		<mass>1000</mass> <zmax>6.0</zmax> <ground_friction>1.0</ground_friction>
		<shape_from_visual/> <!-- automatic size from 3D model file -->
		<!--  Custom visualization model. 3D model filename to load (local or remote http://uri ) -->
		<visual>
			<model_uri>https://mrpt.github.io/mvsim-models/metal-stairs.dae</model_uri>
			<model_offset_z>4.31</model_offset_z>
			<model_roll>90.0</model_roll>
		</visual>
	</block:class>

	<block:class name="tote">
		<mass>6</mass> <zmax>1.0</zmax> <ground_friction>0.1</ground_friction>
		<shape_from_visual/> <!-- automatic size from 3D model file -->
		<!--  Custom visualization model. 3D model filename to load (local or remote http://uri ) -->
		<visual>
			<model_uri>https://mrpt.github.io/mvsim-models/tote.dae</model_uri>
			<model_roll>90.0</model_roll>
		</visual>
	</block:class>

	<block:class name="pallet">
		<mass>2</mass> <zmax>0.1</zmax> <ground_friction>0.1</ground_friction>
		<shape_from_visual/> <!-- automatic size from 3D model file -->
		<!--  Custom visualization model. 3D model filename to load (local or remote http://uri ) -->
		<visual>
			<model_uri>https://mrpt.github.io/mvsim-models/pallet.zip/pallet/pallet.dae</model_uri>
			<model_roll>90.0</model_roll>
		</visual>
	</block:class>

	<block:class name="pallet_jack">
		<mass>20</mass> <zmax>1.5</zmax> <ground_friction>1.0</ground_friction>
		<shape_from_visual/> <!-- automatic size from 3D model file -->
		<!--  Custom visualization model. 3D model filename to load (local or remote http://uri ) -->
		<visual>
			<model_uri>https://mrpt.github.io/mvsim-models/pallet_jack.zip/pallet_jack/pallet_jack.dae</model_uri>
			<model_roll>90.0</model_roll>
		</visual>
	</block:class>

	<block:class name="chair_x3">
		<mass>6</mass> <zmax>1.0</zmax> <ground_friction>0.1</ground_friction>
		<shape_from_visual/> <!-- automatic size from 3D model file -->
		<!--  Custom visualization model. 3D model filename to load (local or remote http://uri ) -->
		<visual>
			<model_uri>https://mrpt.github.io/mvsim-models/chair_x3.dae</model_uri>
			<model_roll>90.0</model_roll>
		</visual>
	</block:class>

	<block:class name="extinguisher">
		<static>true</static> <!-- Does not move -->
		<mass>2</mass> <zmax>1.0</zmax> <ground_friction>1</ground_friction>
		<shape_from_visual/> <!-- automatic size from 3D model file -->
		<!--  Custom visualization model. 3D model filename to load (local or remote http://uri ) -->
		<visual>
			<model_uri>https://mrpt.github.io/mvsim-models/extinguisher.zip/extinguisher/extinguisher.dae</model_uri>
			<model_roll>90.0</model_roll>
		</visual>
	</block:class>


	<!-- ======================================
	      Object instances
	     ====================================== -->
	<!-- You can assign an optional custom name to each object, as an attribute to block, like name="shelf_001", etc. -->

	<!-- All coordinates are global coords: 
	     SE(2) <init_pose>x y yaw(deg)</init_pose> or
	     SE(3) <init_pose3d>x y z yaw(deg) pitch(deg) roll(deg)</init_pose3d> 
	-->

	<block class="shelf"> <init_pose>0 5 0</init_pose> </block>
	<block class="shelf"> <init_pose>0 9 180</init_pose> </block>

	<block class="shelf"> <init_pose>0 -5 0</init_pose> </block>
	<block class="shelf"> <init_pose>0 -9 180</init_pose> </block>

	<block class="shelf"> <init_pose>12 0 90</init_pose> </block>
	<block class="shelf"> <init_pose>17 0 -90</init_pose> </block>

	<block class="pallet_jack"> <init_pose>3 3 0</init_pose> </block>
	<block class="pallet_jack"> <init_pose>-12.5 11.5 -10</init_pose> </block>
	<block class="pallet_jack"> <init_pose>-11 12 80</init_pose> </block>

	<block class="pallet_jack"> 
		<init_pose>0 0 0</init_pose>
		<animation type="keyframes">
			<time_pose>0.0  -13 -3  0</time_pose>
			<time_pose>10.0  5  -3  0</time_pose>
			<time_pose>11.0  5  -3  0</time_pose>
			<time_pose>14.0  5  -3  180</time_pose>
			<time_pose>24.0  -13 -3 180</time_pose>
			<time_pose>25.0  -13 -3 180</time_pose>
			<time_pose>26.0  -13 -3 0</time_pose>
		</animation>
	</block>


	<block class="stairs"> <init_pose>-12 -11.5 -90</init_pose> </block>
	<block class="stairs"> <init_pose> 15  11.5 90</init_pose> </block>

	<block class="tote"> <init_pose>-2 3 -40</init_pose> </block>
	<block class="tote"> <init_pose> 2 3 10</init_pose> </block>

	<block class="pallet"> <init_pose>10.4 -1.1 85</init_pose> </block>
	<block class="pallet"> <init_pose>10.3 -2.3 91</init_pose> </block>
	<block class="pallet"> <init_pose>10.5 1.15 80</init_pose> </block>
	<block class="pallet"> <init_pose>10.2 0.1 86</init_pose> </block>

	<for var="iX" from="0" to="2">
		<for var="iY" from="0" to="1">
			<block class="pallet">
				<init_pose>$f{-7.9+iX*1.3} $f{0.9*iY+2} 0</init_pose>
			</block>
		</for>
	</for>


	<block class="chair_x3"> <init_pose>-14.5 1 90</init_pose> </block>
	<block class="chair_x3"> <init_pose>-14.5 3 90</init_pose> </block>

	<block class="extinguisher"> <init_pose3d>-14.8 12 1.1 90 0 0</init_pose3d> </block>
	<block class="extinguisher"> <init_pose3d> 6.5 12.9 1.1 0 0 0</init_pose3d> </block>
	<block class="extinguisher"> <init_pose3d> 2.5 -12.9 1.1 180 0 0</init_pose3d> </block>

</mvsim_world>
